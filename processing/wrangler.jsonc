/**
 * Mukoko News Processing Worker — Python Data Processing Service
 *
 * Handles: RSS parsing, content cleaning, AI processing, clustering,
 * quality scoring, semantic search, and feed ranking.
 *
 * Called by the main TypeScript Worker via Service Binding.
 */
{
    "$schema": "node_modules/wrangler/config-schema.json",
    "name": "mukoko-news-processing",
    "main": "src/entry.py",
    "compatibility_date": "2025-12-01",
    "compatibility_flags": ["python_workers"],
    "account_id": "125a2dfbc21f76a25c980609609e8218",

    /**
     * Environment Variables
     * Secrets set via: npx wrangler secret put SECRET_NAME --config processing/wrangler.jsonc
     * - ANTHROPIC_API_KEY: API key for Claude via AI Gateway
     */
    "vars": {
        "NODE_ENV": "production",
        "AI_GATEWAY_ID": "mukoko-gateway"
    },

    /**
     * D1 Database — same database as the main worker
     */
    "d1_databases": [
        {
            "binding": "DB",
            "database_name": "mukoko-news-db",
            "database_id": "2f2222f5-7122-4de1-8597-b12c73a9e3f9"
        }
    ],

    /**
     * Workers AI — for embeddings (baai/bge) and AI Gateway (Anthropic)
     */
    "ai": {
        "binding": "AI"
    },

    /**
     * Vectorize — semantic search index
     */
    "vectorize": [
        {
            "binding": "VECTORIZE_INDEX",
            "index_name": "mukoko-news-articles"
        }
    ],

    /**
     * KV — caching layer
     */
    "kv_namespaces": [
        {
            "binding": "CACHE_STORAGE",
            "id": "91721240e81943aa880dfc1b83fa75ff"
        }
    ],

    /**
     * R2 — file storage for feeds and backups
     */
    "r2_buckets": [
        {
            "binding": "STORAGE",
            "bucket_name": "mukoko-news-storage"
        }
    ],

    "observability": {
        "enabled": true
    },

    "placement": {
        "mode": "smart"
    }
}
